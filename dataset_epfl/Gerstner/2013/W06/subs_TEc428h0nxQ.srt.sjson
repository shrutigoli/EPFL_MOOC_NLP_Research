{"start":[0,4270,10020,15540,18320,26670,30170,38130,41080,44630,48860,51590,58580,62070,65740,67550,69790,73280,78930,83040,88910,95900,102250,106010,113300,115160,120390,127080,128930,132360,135370,138740,141640,148730,151610,153020,155090,159630,165830,171820,176690,183850,193100,200110,202920,206800,208030,211290,213070,220700,222620,225580,229100,234840,236400,241260,243100,247570,252050,255950,258980,264355,266990,273070,278180,285810,294500,297500,302450,307980,315660,318920,321570,330440,333980,337620,340750,346020,354150,356930,362580,363830,366830,376310,378272,389580,395440,401360,412930,421056,426182,430210,433520,437740,443370,444620,452600,456780,463360,470250,477770,483270,491180,499180,502040,504820,506070,510370,525610,530530,536670,544850,546020,552690,555360,560716,565700,568850,573950,580600,584394,590530,594140,598680,600490,604340,609530,612370,621630,623220,624460,634160,637560,643780,645030,648640,654520,665440,669300,670830,673650,677600,683200,688360,693960,702530,704760,709670,715940,724590,725520,729000,731880,734440,740540,745140,747670,753620,755440,759010,765910,768060,772760,779840,783215,789280,795520,797710,800390,808680,812540,820840,826100,829080,833780,837150,843810,849295,854740,863280,864530,867690,870830,876180,883310,886460,893230,901140,905410,914200,919280,922330,926680,927930,931270,940430,944250,950460,953590,961140,963250,968260,972250,979520,986000,991480,995730,1001030,1003100,1012330,1019290,1026160,1029810,1031579,1035735,1040130,1044460,1050430,1052720,1056900,1066490,1072010,1075180,1082640,1090830,1097460,1102160,1103720,1106390,1108640,1110610,1115170,1118440,1121000,1129520,1138620,1144340,1152540,1155735,1164750,1170070,1174540,1180250,1185880,1188190,1193990,1196970,1206160,1213852,1215880,1222340,1238820,1240070,1243360,1255520,1257010,1258750,1260000,1263260,1273210,1278410,1289620,1293990,1303310,1305220,1309810,1317210,1324370,1329130,1331740,1335940,1341420,1347190,1349160,1350410,1353060,1360580,1366380,1371160,1372840,1378150,1382020,1384100,1386970,1393000,1398410,1401570,1404050,1409420,1412240,1417820,1424790,1426340,1429070,1433410,1436110,1444410,1451020,1458560,1464110,1467390,1471560,1473160,1474950,1478910,1487740,1497760,1501180,1506400,1510210,1526230,1527480,1530100,1540970,1550360,1561710,1570190,1573045,1577460,1583700,1586640,1590890,1599015,1609210,1611730,1617460,1623790,1625810,1628340,1636870,1642140,1647190,1651150,1658900,1664190,1668850,1672690,1675140,1678010,1683160,1687090,1695420,1699600,1703480,1710270,1714060,1719160,1727810,1730920,1736110,1737860,1743070,1747580,1751080,1752710,1754980,1759880,1766985,1769650,1775700,1777240,1784150,1789760,1792540],"end":[4270,10020,15540,18320,26670,30170,38130,41080,44630,48860,51590,58580,62070,65740,67550,69790,73280,78930,83040,88910,95900,102250,106010,113300,115160,120390,127080,128930,132360,135370,138740,141640,148730,151610,153020,155090,159630,165830,171820,176690,183850,193100,200110,202920,206800,208030,211290,213070,220700,222620,225580,229100,234840,236400,241260,243100,247570,252050,255950,258980,264355,266990,273070,278180,285810,294500,297500,302450,307980,315660,318920,321570,330440,333980,337620,340750,346020,354150,356930,362580,363830,366830,376310,378272,389580,395440,401360,412930,421056,426182,430210,433520,437740,443370,444620,452600,456780,463360,470250,477770,483270,491180,499180,502040,504820,506070,510370,525610,530530,536670,544850,546020,552690,555360,560716,565700,568850,573950,580600,584394,590530,594140,598680,600490,604340,609530,612370,621630,623220,624460,634160,637560,643780,645030,648640,654520,665440,669300,670830,673650,677600,683200,688360,693960,702530,704760,709670,715940,724590,725520,729000,731880,734440,740540,745140,747670,753620,755440,759010,765910,768060,772760,779840,783215,789280,795520,797710,800390,808680,812540,820840,826100,829080,833780,837150,843810,849295,854740,863280,864530,867690,870830,876180,883310,886460,893230,901140,905410,914200,919280,922330,926680,927930,931270,940430,944250,950460,953590,961140,963250,968260,972250,979520,986000,991480,995730,1001030,1003100,1012330,1019290,1026160,1029810,1031579,1035735,1040130,1044460,1050430,1052720,1056900,1066490,1072010,1075180,1082640,1090830,1097460,1102160,1103720,1106390,1108640,1110610,1115170,1118440,1121000,1129520,1138620,1144340,1152540,1155735,1164750,1170070,1174540,1180250,1185880,1188190,1193990,1196970,1206160,1213852,1215880,1222340,1238820,1240070,1243360,1255520,1257010,1258750,1260000,1263260,1273210,1278410,1289620,1293990,1303310,1305220,1309810,1317210,1324370,1329130,1331740,1335940,1341420,1347190,1349160,1350410,1353060,1360580,1366380,1371160,1372840,1378150,1382020,1384100,1386970,1393000,1398410,1401570,1404050,1409420,1412240,1417820,1424790,1426340,1429070,1433410,1436110,1444410,1451020,1458560,1464110,1467390,1471560,1473160,1474950,1478910,1487740,1497760,1501180,1506400,1510210,1526230,1527480,1530100,1540970,1550360,1561710,1570190,1573045,1577460,1583700,1586640,1590890,1599015,1609210,1611730,1617460,1623790,1625810,1628340,1636870,1642140,1647190,1651150,1658900,1664190,1668850,1672690,1675140,1678010,1683160,1687090,1695420,1699600,1703480,1710270,1714060,1719160,1727810,1730920,1736110,1737860,1743070,1747580,1751080,1752710,1754980,1759880,1766985,1769650,1775700,1777240,1784150,1789760,1792540,1794437],"text":["","Welcome to Part 2 of Week 6 of the class Neuronal Dynamics.","In the previous lecture I introduced the notion of stochastic intensity of","escape rates and point processes.","And now, let's use this mathematical framework to discuss the notion of","interspike interval distribution again.","Let's recall the framework that we use for this escape noise modeling.","Let's suppose we inject some fluctuating input","current into a neuron.","We are interested in injecting the same kind of input current into the","mathematical neuron model.","Now, if this is a deterministic signal, then this gives rise to a","membrane voltage of the model.","For example, in the nonlinear integrate-and-fire model, this is","where we inject our current.","We integrate this up.","You generates spikes with our stochastic process.","And afterwards we restart at the reset potential, Ur.","","So if you know the deterministic input, and if you know the firing","time, tf, of the last spike, we know that integration starts at Ur, and we","can just integrate this, and we have our deterministic membrane","voltage, u of t.","Now, this u of t will be sort of the thin line in this graph.","This is the model voltage.","The real neuron would be a thick solid line.","Now, our real neuron, and also our model neuron, now fire at","this moment in time.","I call this firing time, t-hat.","This is the last firing time--","if I'm at time t, I look back-- this is the last firing time of the neuron.","","Now, with this method, I now know that for my model, integration starts again","at some value--","let's put it here--","some value Ur.","I know my current, it's known, for all the future.","So I can construct this deterministic trajectory.","And then the question arises, will this neuron fire again here, or will","it fire again here, or there, or there?","Now, we know that the stochastic intensity or escape rate depends on","the momentary difference between a threshold value","and my membrane voltage.","So there's a likelihood that it fires here.","There's a certain stochastic intensity that it would fire here, or there, or","there, or there.","And now the question is, what's--","this was the last spike--","what's the distribution of these interspike intervals, I-S-I--","Interspike intervals.","","Let's construct this together.","So at any moment in time, there's a certain momentary escape rate.","I'm at time t.","There is this momentary escape rate row of t.","Now I ask--","this was my last firing time, t-hat.","What's the probability that the neuron survives--","starting at t-hat, last firing time--","","that it survives up to this moment, t, without firing?","","So immediately after the spike at t-hat, we start at Ur.","Ur is a long way below the threshold.","Therefore, the probability that it survives for a short moment is 1.","So this survivor function, S of t, given t-hat, will always start at 1.","We know that at the beginning it survives.","And now, as the membrane potential approaches the threshold, there's a","certain probability that it fires, instantaneous radius row.","So we expect that this survival probability will decrease with this","momentary rate row of t.","This is the momentary rate.","So as u of t approaches the threshold, there's an escape rate, and therefore,","the probability to survive will go down.","","So this is the probability of surviving.","Now we can integrate this equation.","So S of t, given t-hat, always starts at 1.","","Now, this is just like radioactive decay, but there's a time-dependent","decay constant.","","So we integrate this row of t prime starting at t-hat.","And then we integrate this--","this is some arbitrary prime time t prime, between t-hat and t.","And in this moment, t prime, I have already a certain escape rate.","And this lowers my survivor function, and I integrate up to time t.","And this is the value, this is the probability to survive without firing","again, up to time t.","","Now, I said we are interested in the interspike interval distribution.","","So far, we just have the survivor probability.","So how do we get from this survivor probability to the interval","distribution?","","Well, what's the probability that a neuron that has fired its last spike","t-hat will fire again at time t?","P of t, given t-hat, gives this as a probability density.","Now, for the neuron, to fire its next spike at time t, it has first to","survive from t-hat to t without firing.","So this interval distribution, P of t, t-hat, will have two factors.","The neuron has to survive from t-hat to t without firing again.","But then it actually has to fire at time t.","Well, what's the rate that it fires at time t?","Well, it's row of t.","","So this is the probability density that, given the last spike at t-hat,","the next spike would occur at time t.","Well, it has first to survive from t-hat to t, and then it has to fire.","So while the survivor probability stays at 1, we know that","no spikes can happen.","And then as this starts to decline, the interval distribution increases.","","Now, the instantaneous rate of firing is very big here.","But hardly any probability is left that the new one would survive","to this time, t2.","Therefore, the interval distribution goes already down again.","So it's not true that the maximum of the interval distribution would lie at","the crossing point of the deterministic potential.","Now, it's absolutely possible that the maximum lies well before.","So let's write this up again.","My survivor function can be calculated by this differential equation, which I","can integrate.","In order to get to the interval distribution, I take the survivor","function part, and then I multiply with the momentary escape rate.","","Now, there is something interesting, and that's this Pi, this interval","distribution--","t of [? tdd, ?] t-hat--","if I compare this and that, then I see I can also write it as minus ddt S of","t, given t-hat.","If I take the derivative of this exponential term, it just pulls down","this row of t.","","Now, this is a time-dependent interval distribution.","As I explained on an earlier slide, we give some time-dependent input, some","fluctuating input, a deterministic, a known signal, the [? gift ?]","is in here.","And in the presence of this time-dependent input--","and that's highlighted by this index I here--","I can calculate the probability density that the next spike occurs at","t, given I know the last firing time was at t-hat.","So this survivor function can be written in the general case with this","index I. And of course, this row also is input dependent.","Now let's discuss the two examples.","The first example is that of constant input.","As a constant input, which I apply all the time, now with this constant","input, stochastically, because of this stochastic intensity, a","spike happened here.","Now I know the last firing time for all the future","times, t, has been here.","","Now, after the last firing time, the membrane potential was reset.","The survivor function starts at a value of 1, and then","it goes down again.","The interval distribution is biggest in the region here where their","survivor function goes down rapidly.","","Now, if I have constant input, then the input is constant.","That's this little 0 here.","It has no time-dependent input, so I don't keep the index I.","But moreover, the remaining time dependence, you see that the membrane","potential still has a time dependence.","Now, this remaining time dependence is due to the reset at time t-hat.","And so, the time dependence is completely described by the time","difference, t minus t-hat.","","So this becomes a function which just depends on t minus t-hat.","","And so this would be, since this only depends on t minus t-hat, this will","also only depend on t minus t-hat.","And so does the interval distribution.","It's just a function of t minus t-hat.","","Now, this situation of constant input where the escape rate just depends on","t minus t-hat is called renewal theory.","","For the case of renewal theory, the stochastic intensity is also called","the hazard.","","This is, again, the survivor function.","","And if we use this terminology of survivals, then the hazard is, so to","speak, the hazard of time.","Now what I've shown on the earlier slides is that this renewal theory for","constant input is a special case of our more general scenario.","If I have a time-dependent input, and the membrane potential is truly","time-dependent, the time dependence arises from both the external input.","And, in addition, for integrated fire model with reset, I need to know the","last firing time, t-hat.","And that's why I've written here the voltage as u of t, given t-hat.","I have to know t-hat.","","In this case, I have an input dependent survivor function, which","depends on this row here.","And I can calculate this input dependent interval distribution just","the same way as in renewal theory.","In other words, you have arrived at a time-dependent version of standard","stationary renewal theory.","","Now let's see what we can do with these notions.","One thing is for an interpretation of this escape rate, but also for","simulations on a computer, we have to work in discrete time.","So suppose I have some discrete time steps, and from time to","time there is a spike.","So let's draw a couple of these discrete time steps, and I have a","couple of spikes.","So these are the firing times.","The firing times have a upper index.","Now, an arbitrary time step, for example, this guy here, is tk.","It's the lower index.","And I should be more precise.","So let me redraw this arrow.","","tk is the tic.","And then this here, this tic here, would be tk plus 1, the","next moment in time.","So a time step has a certain duration.","So this duration here would be delta.","And now the question is, I have my newer model, the one with escape","noise, with stochastic intensity.","And I would like to know what's the probability that the neuron survives","from tk to tk plus 1, through the whole time step delta, without firing.","So the probability to survive for one time step is--","now, starting at tk, this is not necessarily to reset, this is not","necessarily the way of firing time.","This is my time bin--","this is the start of my time bin--","up to the next time bin.","What's the probability to survive for this time, delta, for one time step?","Well, just as before, it's just exponentially we have","to integrate this.","Now, if the time steps are small, then this function row of t, which I would","like to draw now here, roughly, this function row of t will not change a","lot within tk and tk plus 1.","So for this integral here, I can approximate this by","row of tk times delta.","","Now, the next question is, from time to time we have these spikes.","So this would be a time bin where the neuron has fired.","So what's the probability to fire in one time step?","Well, this probability, let's call it PF, F of firing, firing in","the time step k.","Well, the probability to fire in one time step, that's the probability that","you do not survive without firing.","So this is 1 minus S of tk plus 1, starting at tk.","So this would be using this expression here, 1 minus e to the--","and there's a minus sign missing--","e to the minus row of tk times delta.","Now, row of tk is my escape function, f of u minus theta evaluated at this","moment, tk.","","We have seen that this function f may explode for u [INAUDIBLE]","and theta.","It just goes up to infinity.","It does not saturate.","","Now, if you evaluate this finite time step probability, you take this","unbounded f, you plug it into this formula here.","Then this probability of firing is bounded to 1, as it should be.","","Now this can be used, in fact, to determine, experimentally, the shape","of the function f.","So let's come back to our situation where we inject a time-dependent","current into a real neuron, and also into the mathematical neuron model.","The mathematical neuron model could be your integrated fire model, and you","can use this time-dependent current, the known signal, to calculate the","membrane potential of our neuron model.","This model membrane potential is the thin line here.","","You also do recordings from the real neuron, and the real neuron will be","the thick line.","This is the data.","","Now from time to time, the real neuron emits a spike.","Now what we find is that if you look at these kind of recordings, there's","several repetitions of the same time-dependent input current, the same","signal I of t.","If you look at several recordings, then the membrane potential is","slightly different, and moreover, the spike times are slightly different","between one trial and the next.","","So let's use this to our advantage, so as to find out what the intrinsic","noise sources of the neuron are, of this intrinsic escape rate","of the neuron is.","The way we do this is the following.","Let's look at some value, say, a point here.","This point here.","This is a certain value, U, of my model.","And this is my U model, which is just below theta.","Say it's this value here.","","Now for this value here of my model, I see that the neuron","here has not fired.","Now, I look at all the cases here I have the same value of U model, and I","count the number of fins where the neuron does not fire.","So this is the number of counts where it's not firing.","But from time to time, for the same voltage of the model, say a point","here, the neuron actually fires.","So I also have instances where, for this very same","voltage the neuron fires.","And that's the black part here.","So there are very few instances, but there are.","So this black thing would be the n firing at the same voltage.","Now, let's compare the number of fins where the neuron fired, to the total","number of fins that are found that this voltage.","Well, the total number of fins are those where the neuron fired, plus","those, where the neuron did not fire.","Now, if I do this for a fixed voltage u, then I find my firing probability","for this voltage.","","Experimental firing probability, PF of u, are these data points.","On the other hand, from my escape noise model, formalism, I know that","this probability PF of firing at a time bin, a time bin where the escape","rate row of t was given by u minus theta and then times delta.","Let me put the delta up here.","","So this is my firing probability for this voltage, with a","certain escape rate.","I can use to extract the escape rate.","For example, let's say my escape rate, f of u minus theta, is the exponential","one, e to the minus, u minus theta over some parameter a.","","And that would be a rate constant in front.","This is a fixed parameter that characterizes defined rate at the","threshold, if u is equal to theta.","","Now, if you use this exponential function F in this discrete time","formula, PF, then we get this solid line.","So we see that there's an excellent fit of the exponential escape","rate and the data.","In other words, the exponential escape rate that I introduced earlier is a","reasonable or in a very good approximation to the intrinsic noise","sources in neuronal membranes--","intrinsic noise sources that contribute to the","firing of the neuron.","So let me summarize.","In the first lecture today, I have introduced the notion of stochastic","processes, the notion of escape rates.","Now we have seen here that we can translate this continuous time escape","rate into a discrete time firing probability.","And we can match this firing probability to data.","Moreover, the formalism of stochastic point processes allows us to calculate","things like interval distributions.","In the case of a constant external input and integrating file model with","resets at each moment of firing, you are in the framework of standard","stationary renewal theory.","In this case, the escape rate corresponds to the hazard of the","renewal model.","But we also have seen that the formalism is much more general and can","account for arbitrary time-dependent input.","And this leads to the notion of arbitrary time-dependent interval","distributions.","And we can calculate this.","Now this is important because the methods that are described in this","lecture now are the basis for the likelihood of a spike train, which you","will see in the next lecture.","But also the basis for modern methods of neuron model fitting, that we will","see next week.","Please have a look and take some time with the homework assignments so that","you get acquainted with the notions of time-dependent, interval distribution,","hazard, escape rate, and so forth.",""],"paragraphs":[0,4270,10020,30170,38130,51590,83040,106010,120390,141640,165830,176690,200110,225580,241260,266990,285810,297500,307980,321570,337620,366830,426182,437740,463360,483270,510370,536670,555360,573950,590530,612370,648640,688360,702530,734440,759010,772760,800390,837150,854740,886460,914200,931270,968260,1003100,1029810,1052720,1090830,1110610,1121000,1144340,1164750,1180250,1206160,1222340,1243360,1263260,1305220,1317210,1341420,1353060,1386970,1401570,1429070,1451020,1467390,1487740,1510210,1540970,1577460,1586640,1628340,1651150,1675140,1687090,1703480,1737860,1754980,1777240]}