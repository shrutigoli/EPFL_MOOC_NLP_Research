{"start":[0,4090,8109,13340,18860,25680,27960,38310,40660,46980,49090,54060,56390,62300,63550,66110,69880,73430,80550,87220,95740,98760,101590,105020,106470,110600,118860,128389,131250,136580,139150,144740,150920,153390,156270,164035,170230,174520,180560,186860,197460,201710,203900,206790,209310,214150,218760,226050,227420,230370,233615,238350,247280,255280,258890,262270,271820,274125,277050,285840,295640,300450,300910,308000,310320,313410,320410,323435,327230,333000,336960,341090,343710,347952,354120,358020,361100,367275,370180,372310,374080,380140,381530,390365,394120,405040,408690,410680,413720,417620,422860,429320,436330,439760,443060,446915,450340,459420,464930,469240,476490,479190,482470,486960,490290,498440,505250,512735,519250,525190,531240,536670,539980,543760,547250,549940,552440,560570,561820,566020,576620,578180,581530,585750,593820,599240,601380,608290,616720,622010,624510,634680,637130,639280,640615,641200,643000,645220,647540,658890,660140,662680,670720,678420,683390,687760,694740,698552,704220,710980,721710,735190,743240,744520,751550,759190,762470,775450,782690,800640,814420,818630,824350,830660,833330,837230,842760,845500,850480,855350,858135,867780,876550,882080,883330,888950,893210,901140,902390,904080,909900,912600,913850,917150,919460,923090,929380,932790,938060,940530,942670,947440,950390,957130,962060,965420,975080,978640,984780,988360,996660,1002243,1006810,1008700,1012280,1017100,1019660,1023610,1031829,1035150,1038805,1042089,1047190,1052690,1055412,1057500,1063430,1068380,1071540,1078700,1084590,1088080,1092200,1096780,1098030,1100490,1104940,1107790,1115310,1116560],"end":[4090,8109,13340,18860,25680,27960,38310,40660,46980,49090,54060,56390,62300,63550,66110,69880,73430,80550,87220,95740,98760,101590,105020,106470,110600,118860,128389,131250,136580,139150,144740,150920,153390,156270,164035,170230,174520,180560,186860,197460,201710,203900,206790,209310,214150,218760,226050,227420,230370,233615,238350,247280,255280,258890,262270,271820,274125,277050,285840,295640,300450,300910,308000,310320,313410,320410,323435,327230,333000,336960,341090,343710,347952,354120,358020,361100,367275,370180,372310,374080,380140,381530,390365,394120,405040,408690,410680,413720,417620,422860,429320,436330,439760,443060,446915,450340,459420,464930,469240,476490,479190,482470,486960,490290,498440,505250,512735,519250,525190,531240,536670,539980,543760,547250,549940,552440,560570,561820,566020,576620,578180,581530,585750,593820,599240,601380,608290,616720,622010,624510,634680,637130,639280,640615,641200,643000,645220,647540,658890,660140,662680,670720,678420,683390,687760,694740,698552,704220,710980,721710,735190,743240,744520,751550,759190,762470,775450,782690,800640,814420,818630,824350,830660,833330,837230,842760,845500,850480,855350,858135,867780,876550,882080,883330,888950,893210,901140,902390,904080,909900,912600,913850,917150,919460,923090,929380,932790,938060,940530,942670,947440,950390,957130,962060,965420,975080,978640,984780,988360,996660,1002243,1006810,1008700,1012280,1017100,1019660,1023610,1031829,1035150,1038805,1042089,1047190,1052690,1055412,1057500,1063430,1068380,1071540,1078700,1084590,1088080,1092200,1096780,1098030,1100490,1104940,1107790,1115310,1116560,1119270],"text":["","Welcome to the third part of week six.","In the previous lecture I've explained how to calculate things like the","Interspike interval distribution, how to calculate the survivor function.","We'll now use these notions to look at the likelihood of an","observed spike train.","Suppose an experimentalist has injects a signal into a neuron.","And he observes spike times.","Suppose a first spike at time t1, a second time at time t2, a third spike","at time t3.","The upper index indicates the firing times.","Firing times are events.","And the spike train as a whole is a sequence of events we presented as a","sequence of delta pulses.","","Now, you as a modular have a model.","You inject the same current.","And you add its [INAUDIBLE] noise so that your model also generates spikes.","Now you ask what's the likelihood that this spike train with defined times at","t1, t2 and t3 could have been generated by your model?","Now, here's the answer.","You can write down the likelihood.","Now of course, this needs some explanation.","That's what I will do now.","So here again, my sequence of spikes.","We have seen in part two that we can discuss the question what's the","likelihood that a neuron would survive a certain interval from t1 to t2","without firing?","So what's the probability to survive?","Well, it's given by the survivor function.","At each moment the neuron has a certain rate of firing.","At this moment, say, t, it has a certain rate row of t.","But we observe that it did not fire.","","The probability to survive without firing decays exponentially.","","And it doesn't fire in the whole interval from t1 to T2.","So we integrate this instantaneous rate from t1 to t2.","And then again, the neuron should stay silent.","It should survive from t2 to t3 without firing.","","t2 is this firing time here.","t3 is the next firing time.","Firing times are the upper index.","So this must be in upper index here and there.","But then the neuron actually has to fire at time t2.","Well, it does so with a firing intensity row or t,","evaluated at time t2.","","Similarly, it has to fire here, at t3.","","And then it doesn't fire again between t3 and T, capital T. So it's, again,","times e to the minus from t3 to the end of the measurement period, row of","t prime, dt prime.","And note it stays silent at the beginning.","So I have e to the minus, 0 too t1, row of t prime, dt prime.","And it did fire at time t1.","","So the likelihood that within this period, from 0 to t, we would observe","just three spikes at times t1, t2, and t3 is, therefore, this.","Now, working with these instantaneous rates, stochastic intensities with","[INAUDIBLE]","rates in continuous time sometimes causes problems.","It's hard to imagine this.","And sometimes it's easier to think in discrete time.","Moreover, any computer implementation has to happen in discrete time.","So let's introduce some discrete time bins.","","So I introduce my time bins like this.","And let's look at this time bin, at this moment of time here.","I call this tk.","Now, let's look at this moment here.","This would be tk plus 1.","The lower index k is an index of the time bin.","The upper index, f, is an index for the firing times.","","Now, let's look at the probability to survive this interval, delta--","","the time step delta--","without firing.","The probability to be silent in this interval delta is given by the","survivor function.","I integrate from tk to tk plus 1, row of t prime, dt prime.","","Now, suppose that this is the time dependence of my functioned row of t,","which I need to evaluate at these different moments in time.","This would be at tk.","This would be at tk plus 1.","And you see that it changes only slowly.","The difference between the value here and the value here is marginal.","Whereas at some other times you might have a completely different value.","So if I say that row changes little in a small time step then I can","approximate this by the following expression.","I just evaluate at time tk.","And then I multiply for the duration of this integral.","","So the probability to stay silent in these different time steps here, time","steps, time moments, k prime, would be you need to stay","silent in one time step.","Say row of tk prime times delta.","And then you have to stay silent again in the next time step.","","tk double prime times delta would be the next time step.","I have exponentials here.","The product of exponentials can be written as a sum, row of tk prime, a","sum over all k prime times delta.","Now, a sum of all tk primes that lie in between t2 and T3.","","I do something similar for the interval from t3 to capital T for this","interval and for this interval here.","So far, for the periods where the neuron does not fire.","But then there are these moments and the neuron does fire.","For example, in this interval here.","Well, the probability to fire is 1 minus the","probability of staying silent.","","So this is 1 minus e to the minus, row of tk times delta, in the","approximation I made here.","","And I have to add all these different moments, P of t f delta, for all the","moments where I have firing.","","Product of all firing times.","This is the sum of all bins where the neuron stays silent.","So this is the discrete time construction of a likelihood.","Now, let's ask the following question--","what happens if I make this bin size, delta, smaller and smaller?","So for this bin size here I said, I for sure know probability, which is 1","minus e to the row of tk times delta.","","Now, the Taylor expansion of e to the x is something like 1 plus x plus a","term, x squared, and so forth.","So if x is small--","and that's the case--","[INAUDIBLE]","take delta very small.","So this is going to be very small.","I can use this Taylor expansion.","And I arrive at row of tk times delta, which becomes developed if delta gets","very small.","","So now, consider the transition from time steps of duration delta to time","steps of half the size, delta prime equals delta over 2.","Well, now, I had a certain probability to fire in that time step.","I must have a smaller probability to fire in the short time step.","Because the total duration to fire between here and here, the total","probability to fire between here and there should not change.","And that's true for this firing probability that is proportional to","the step size delta valid in the limit delta to 0.","Now, all the survival terms that I have for the silent periods have to","form into the minus sum over k prime row of tk prime times delta.","If I take the limit of delta to 0 then this transforms back into our","[? unknown ?]","integral, row of t prime, dt prime.","And the intervals go over all these silent periods from a first firing","time to the next firing time.","Now, if you write down the likelihood in discrete time for a situation with","exactly end spikes then we would have the product of all these different","firing times, f equal 1 to N, row evaluated at tf times delta,","multiplied with the survivor function going from tf to tf plus 1","of t prime, dt prime.","The product is of these different firing times.","Plus I should add the intervals at the beginning, at the end.","I don't have the space to do so.","And it's not important for the augment that I'm going to make.","Now, what you see is that in this discrete time formulation of the","likelihood I have this term, delta.","","I have a term delta for each firing time.","So overall, I can move that in front.","","The script L, for the discrete time likelihood is related to the factor","delta to the n, that delta is the step size to the continuous time","likelihood.","","L continuous time likelihood is really a density.","And you have to integrate it N times to get a quantity that's related to a","probability.","","So it's this continuous timed likelihood is an N-fold density.","And here it's again, our density.","This is the first interval.","","Then I have my spike.","This is the second interval.","Then I have my spike and so forth, until I have the last interval.","I can rewrite this in a slightly different form.","We see that this integral here goes up to t1.","But the next integral starts at t1.","It goes up to t2.","The next integral would start at t2, go up to t3 and so forth, until the","final one, which goes from [? tN ?]","to capital T. So all these terms give rise to one single integral over the","whole period, the whole measurement interval, from 0 to t.","","The moments of firing for end spikes that equal 1 to N, I have N","instantaneous fine rates.","Now, sometimes the likelihood is not written in this form but is","transformed to a log likelihood.","So if I take the logarithm, of this likelihood L, well, the logarithm of","the exponential is just determine the argument of the exponential.","","Then I have a product.","The logarithm of a product gives a sum.","In fact, I have many products that turn into a sum over all","spikes row of tf.","","Thus the likelihood can be rewritten as a log likelihood.","And the two formulations are completely equivalent.","I can also go back from the log likelihood to the likelihood.","","The reason for concentrating the log likelihood is simple.","It looks nicer if you have sums compared to products.","Let me summarize this.","An integrated fire model with [INAUDIBLE]","noise can be seen as a stochastic spike generator.","It can be seen as a generative model, a model that can","generate spike trains.","If you have observed a spike train we can ask what would be the likelihood","that this spike train could have been generated by my model?","And the nice thing is you can write down.","You can consulate this likelihood.","Now, a model such as the [? integrated ?] file model will have","parameters, for example, the threshold.","","We are able to calculate this likelihood for different","values of the threshold.","And as we will see next week, this is the basis for optimizing parameters of","such a neuron model.",""],"paragraphs":[0,4090,27960,66110,95740,106470,136580,150920,174520,201710,214150,238350,258890,277050,310320,327230,341090,361100,394120,413720,439760,476490,505250,543760,593820,624510,645220,678420,710980,762470,824350,837230,867780,904080,917150,932790,942670,988360,1012280,1035150,1052690,1084590]}