{"start":[0,4710,9350,16390,20550,25965,28000,33100,35190,36880,41240,43590,49330,53720,60870,65550,67280,72740,74500,79880,82350,87440,90120,92140,94640,99130,101050,104750,108120,111640,119670,123730,134430,139590,142620,145480,152870,155340,167920,171240,175030,178100,181590,186100,188450,191395,194280,197950,203090,211470,215710,224600,228320,233160,234936,241940,243940,245836,249300,252040,254190,259760,263360,267250,269500,274390,283520,287170,296440,299300,304080,308500,319420,328560,331850,338440,343140,347250,351580,357450,360310,363300,371350,374470,378470,381940,387360,390530,395560,396400,403220,410170,411530,415710,420590,421865,424700,427530,430340,432760,438780,439880,443230,447460,455710,460540,466730,472910,476270,484900,486390,489710,498280,505050,508920,514460,524039,529595,532350,538290,541770,548230,551020,562990,571670,574205,578340,586830,588790,599570,609320,620010,628710,635130,639560,648860,650150,653580,657260,659995,662870,673060,675600,678890,682540,690070,699740,704710,710750,714690,717960,719640,722200,725060,731000,732250,736300,739410,742890,748290,751560,756800,762800,764050,768590,773740,777940,782180,784150,787170,793720,798690,802390,806550,813010,816620,822340,828510,831950,837940,842540,848825,853140,856720,862360,863610],"end":[4710,9350,16390,20550,25965,28000,33100,35190,36880,41240,43590,49330,53720,60870,65550,67280,72740,74500,79880,82350,87440,90120,92140,94640,99130,101050,104750,108120,111640,119670,123730,134430,139590,142620,145480,152870,155340,167920,171240,175030,178100,181590,186100,188450,191395,194280,197950,203090,211470,215710,224600,228320,233160,234936,241940,243940,245836,249300,252040,254190,259760,263360,267250,269500,274390,283520,287170,296440,299300,304080,308500,319420,328560,331850,338440,343140,347250,351580,357450,360310,363300,371350,374470,378470,381940,387360,390530,395560,396400,403220,410170,411530,415710,420590,421865,424700,427530,430340,432760,438780,439880,443230,447460,455710,460540,466730,472910,476270,484900,486390,489710,498280,505050,508920,514460,524039,529595,532350,538290,541770,548230,551020,562990,571670,574205,578340,586830,588790,599570,609320,620010,628710,635130,639560,648860,650150,653580,657260,659995,662870,673060,675600,678890,682540,690070,699740,704710,710750,714690,717960,719640,722200,725060,731000,732250,736300,739410,742890,748290,751560,756800,762800,764050,768590,773740,777940,782180,784150,787170,793720,798690,802390,806550,813010,816620,822340,828510,831950,837940,842540,848825,853140,856720,862360,863610,864826],"text":["","Welcome to part 5 of week 7 of the class Neural Dynamics.","In the previous part, I reascended the spike response model with escape noise","as a realization of a generalized linear model.","Let's now talk about how to optimize parameters of such a neuron model.","Here again are our model.","Input is filtered by a first filter kappa.","This is this term over here.","Inject a known input.","It's filtered with this filter kappa and that contributes to","the membrane potential.","Than this membrane potential is compared with a threshold, and","depending on the distance between membrane potential and threshold,","spikes are generated stochastically, and these spikes are fed back by a","filter eta, which contributes to the membrane potential.","So this feedback is shown here.","The spike train is filtered with this filter eta, and that contributes to","the membrane potential.","So eta is something like the spike after potential.","And experimentalist injects the current.","So we have a known input, and at the same time, he","observes the spike train.","The spike train is known as well.","","Now, the voltage, given this spike train and given input, is just a","linear convolution.","It's linear in the parameters.","Let me explain what this means.","In practice, we work in this great time.","So this integral over past input with a filter kappa is transformed into a","sum over time steps.","So k is an index, the lower index here, and k runs from 1 to capital K.","So k sub 1 would be this first entry.","1 time step later, I have k sub 2.","The last entry is k sub k.","This is like having a continuous filter shape, kappa of s, and the","readout at discrete times.","So k sub 1 is proportional to kappa at 1 times dt, where dt is the time step.","Now, what can we do with this kind of description?","Well I said already that the experimentalist injects a current into","a real neuron and he measures the voltage.","So we have access to the spikes, that's the peaks over here, the action","potentials, and we also have access to the voltage trace","in between the spikes.","So I call this voltage trace u data.","","Now, as a modeler, I inject the same current into my mathematical neuron","model and using this convolution transformed into a discrete time,","summation gives me my model u of t.","What we need to do is, we need to compare the two.","We need to adjust the parameters such that u of t is as close as possible to","the measured theta.","Now, let me come back to the notion of linear in the parameters.","I know the current.","The voltage of my model is just linear in the parameters.","There's no square root of k.","There's no k to the cube.","It's just linear, and that's important.","","So here's my current.","Now again, experimentalist inject a current, but in his set up, typically,","it's a digital set up, so he injects current indiscrete time steps.","One time step might be 0.1 milliseconds, something very short or","a little bit longer, 1 millisecond.","So the current is a discrete sequence of times.","So this would be say my moment, , t that I'm interested in, t, and I have","a current at this specific moment, let's call it tn.","I have a current in this time bin which is i sub n.","And now we measure data.","The data might be like this in this time step.","Now, the current was different in previous time steps.","So what we do in this formula is, we take the current at time step n, n","minus 1, and compare it and multiply it with a filter evaluated at 1, so k1","times current n minus 1.","And then we look at the current at n minus 2.","So this one here would be n minus 2.","And take the filter at this moment here, k2.","","This is how we calculate the voltage at time n of the model.","Now, this is the model voltage.","Here is the measured data voltage.","What I would like to have is that the data voltage at time tn is as close as","possible to the model voltage.","The model voltage is this term here.","Comes from over there.","Now, this is true, this is my wish for tn, for this time point here.","But that should actually be true for all different time points.","The data is different in each time step, and it should be true for all","time steps.","So this index n runs over all the different time steps.","First index k runs from 1 to capital K. The capital K is","the end of the filter.","K times delta t is the duration of the filter.","Let's compare my data with my model.","I sum up all time steps.","","e is supposed to be an error function.","An error should be positive.","That's the main reason why I square this.","So the data voltage is larger than the model voltage or smaller than the","model voltage.","In both cases after squaring, I get a positive error.","","Now, let's plot this ever here, this, error as a function of one of the","parameters, for example, the parameter k sub 3.","e is a function of k1, k2, k3, and so forth.","So just take out one of these, say k3, and I plot e as a function of k3, and","it will look like this.","And then I will choose the value k3, the optimal value, k3 opt is the one","where this function is at a minimum.","","Now, since the voltage is linear in the parameters, the square of the","voltage is quadratic in the parameters.","In particular, it's a quadratic function of k3.","Just take the square and multiply it out, and it will have terms of the","form u data squared in terms of the form u data times kk, say k3, and then","you will have terms of the form k3 i n minus 3 squared,","which means k3 is quadratic.","So this function is quadratic in the parameters, and that means I can","directly calculate the optimal value.","Now, sometimes instead of writing these sums, it's more convenient to","think of a vector notation.","So here again, my current i of t, and this will be my value i at times n.","And this will be my value i at times n minus 1, and maybe this one i at times","n minus 1, 2, 3, 4.","","So let's take this summation as a vector product.","I say I have this filter.","My filter k is indeed a vector with entries k1, k2, up to k lower index","capital K, and I multiply this with a vector xn.","xn would be my value at times i n, my current value at times n minus 1, my","current value at times n minus k, and I made a mistake here.","The vector starts at n minus 1 to be multiplied with k1.","k1 is multiplied with n minus 1.","So with this notation, I get u of t n is just my filter k as a vector times","the vector x n.","Now, this was one of the vectors.","xn corresponds to the time point n.","But we have many different time points in this sum.","","So for example, at time t equals k plus 1, I have the current at time k","minus 1, k2, and so forth.","At time k plus 3, I have the current at the time k plus 2, k","plus 1, and so forth.","Now, all these different entries are assembled in the lines.","And then this way this whole formula becomes an exercise in optimization of","a quadratic expression that includes matrices.","So far I just treated the input current and the filter k, and I","constructed this matrix of inputs.","I said earlier that the experimentalist also observes the","spike times.","The eta is not the linear filter.","It can be treated just the same way.","And we can have extra entries for the filter eta and observed spike","times in the past.","So the total voltage it's just a generalized version of this one.","Again, it remains linear in the parameters.","It's linear in the parameters of the filter kappa.","It's linear in the parameters of the filter eta, and therefore, we have a","quadratic problem.","Now, if you apply this in order to optimize parameters of the sub","threshold potential of a real neuron, let me find a filter kappa, which","looks like this.","","And in fact, it can be fitted just by an exponential function.","This would be the filter of an inhibitor neuron.","Here's the filter of an excitatory neuron, again, an exponential filter","with slightly different parameters.","","Now, if we extract the filter eta by this quadratic optimization procedure","from the quadratic error function, then you would find a negative spike","after potential for parametal neurons.","There's inhibitor neurons, first a negative contribution, a high","polarizing spike after potential followed by a depolarizing, a little","bump, a depolarizing spike after potential.","That's what we have seen so far is with a GLM, with a spike responds","motive with escape noise, we can optimize parameters in","a systematic fashion.","We can find the best prediction of the sub threshold voltage by solving a","quadratic optimization problem, by finding the minimum of a quadratic","error function, and therefore, straightforward procedures exist.","But so far, our approach has been limited to the sub","threshold membrane potential.","Ideally, from a neuron model, we would also like to predict spikes, and","that's next.",""],"paragraphs":[0,4710,28000,65550,94640,123730,155340,194280,228320,252040,274390,304080,351580,381940,415710,447460,489710,532350,578340,635130,675600,714690,739410,768590,802390,816620,848825]}